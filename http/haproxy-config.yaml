apiVersion: v1
kind: ConfigMap
metadata:
  name: haproxy-config
data:
  haproxy.cfg: |
    global
        log stdout format raw local0
    defaults
        log global
        mode http
        option httplog
        timeout connect 5000ms
        timeout client 50000ms
        timeout server 50000ms
    frontend http_front
        bind *:8080
        default_backend lighttpd_back
    backend lighttpd_back
        balance roundrobin
        # Apuntamos al DNS interno del servicio de Kubernetes
        server lighttpd_srv lighttpd-service.default.svc.cluster.local:80 check
